const ChallengeFromCSV={start:(t,e,r)=>{ChallengeFromCSV.fileParse(t).then(t=>ChallengeFromCSV.sendData(t,e,r))},sendData:(t,e,r)=>{ChallengeFromCSV.postRequest("https://habitica.com/api/v3/challenges",e,r,t.Cdata).then(function(a){id=JSON.parse(a).data.id;for(const a of t.tArray)ChallengeFromCSV.postRequest("https://habitica.com/api/v3/tasks/challenge/"+id,e,r,a)})},postRequest:(t,e,r,a={})=>{return new Promise((s,i)=>{let c=new XMLHttpRequest;c.open("POST",t),c.onerror=function(){i(this.responseText)},c.onload=function(){c.status,s(this.responseText)},c.setRequestHeader("Content-Type","application/json;charset=UTF-8"),c.setRequestHeader("x-client","456b5feb-bd5c-4046-b5b3-83606a1f6a76-cfc"),c.setRequestHeader("x-api-user",e),c.setRequestHeader("x-api-key",r),c.send(JSON.stringify(a))})},fileParse:t=>new Promise(function(e,r){FileList=t.files,FileList.length>1&&console.error("multiple files selected"),File=FileList[0];var a=new FileReader;a.readAsText(File),a.onload=function(t){for(Text=t.target.result,tempArray=Text.split("\r\n"),Cdata={group:tempArray[4],name:tempArray[0],shortName:tempArray[1],summary:tempArray[2],description:tempArray[3],prize:tempArray[5]},tArray=[],task=!1,i=6;i<tempArray.length;i++){switch(taskArray=tempArray[i].split(";"),tObject={type:taskArray[0],text:taskArray[1],notes:taskArray[2]},taskArray[3]){case"Trivial":priority=.1;break;case"Easy":priority=1;break;case"Medium":priority=1.5;break;case"Hard":priority=2}switch(taskArray[0]){case"habit":tObject=Object.assign({priority:priority,startDate:taskArray[4]},tObject);break;case"daily":switch(tObject=Object.assign({priority:priority,frequency:taskArray[5],startDate:taskArray[4]},tObject),taskArray[5]){case"daily":tObject=Object.assign({everyX:taskArray[6]},tObject);break;case"weekly":for(days=taskArray[6].split(","),str="{",j=0;j<days.length;j++)0!=days.length&&(str+='"'+days[j]+'":false',j!=days.length-1&&(str+=","));str+="}",tempObject=JSON.parse(str),tObject=Object.assign({repeat:tempObject},tObject);break;case"monthly":for(weeks=taskArray[6].split(","),str="{",j=0;j<weeks.length;j++)0!=weeks.length&&(str+='"'+weeks[j]+'":false',j!=weeks.length-1&&(str+=","));str+="}",tempObject=JSON.parse(str),0==taskArray[7]?(dom=taskArray[8].split(","),tObject=Object.assign({repeat:tempObject,daysOfMonth:dom},tObject)):(wom=taskArray[8].split(","),tObject=Object.assign({repeat:tempObject,weeksOfMonth:wom},tObject))}break;case"todo":tObject=Object.assign({priority:priority,date:taskArray[4]},tObject);break;case"reward":tObject=Object.assign({value:taskArray[3]},tObject)}tArray.push(tObject)}e({Cdata:Cdata,tArray:tArray})}})};
